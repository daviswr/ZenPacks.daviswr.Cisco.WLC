name: ZenPacks.daviswr.WirelessController

class_relationships:
  - Controller(aaaServers) 1:MC AAAServer(controller)
  - Controller(apGroups) 1:MC APGroup(controller)
  - Controller(dhcpPools) 1:MC DHCPPool(controller)
  - Controller(licenses) 1:MC License(controller)
  - Controller(vlanInterfaces) 1:MC VlanInterface(controller)
  - Controller(wlans) 1:MC WLAN(controller)
  - APGroup(accessPoints) 1:MC AccessPoint(apGroup)
  - AccessPoint(apRadios) 1:MC APRadio(accessPoint)
  # Aruba-specific
  - ArubaController(arubaRemoteController) 1:MC ArubaRemoteController(controller)
  # Use stock component classes for CPU, fan, and power


classes:
  DEFAULTS:
    base: [zenpacklib.Component]

  Controller:
    base: [zenpacklib.Device]
    label: Wireless Controller
    short_label: Controller
    properties:
      # Aruba - wlsxSysExtHwVersion.0
      # Cisco - entPhysicalHardwareRev.1
      hwVersion:
        type: string
      # Set by license modeler?
      maxAPs:
        type: int
      # Aruba - mobilityDomainName ("default" has no Name entry)
      # Cisco - bsnRFMobilityDomainName
      mobilityDomains:
        type: lines
      # Cisco - agentInventoryMaxNumberOfAPsSupported 
      platformMaxAPs:
        type: int
      # Aruba - wlsxSwitchRole
      # Cisco - Check licenses to determine if HA SKU?
      role:
        type: string
      tempThresholdLow:
        type: int
      tempThresholdHigh:
        type: int

  ArubaController:
    base: [Controller]
    label: Aruba Mobility Controller
    short_label: Aruba Controller
    properties:
      local:
        type: boolean
      master:
        type: boolean
      # wlsxSwitchMasterIp
      masterIP:
        type: string

  ArubaInstantController:
    base: [ArubaController]
    label: Aruba Instant Virtual Controller
    short_label: Aruba Instant
    
  CiscoController:
    base: [Controller]
    label: Cisco Wireless LAN Controller
    short_label: Cisco WLC

  CiscoIOSController:
    base: [CiscoController]
    label: Cisco IOS Wireless Controller
    short_label: Cisco IOS WLC
      
  AccessPoint:
    label: Abstract AP
    short_label: AP
    relationships:
      apRadios:
        grid_display: false
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # Aruba - wlanAPNumRadios
      # Cisco - bsnAPNumOfSlots
      radioCount:
        label: Radio Slots
        type: int
        order: 3
        details_display: false
      # Aruba - wlanAPLocation, wlanAPSysLocation?
      # Cisco - bsnAPLocation
      location:
        label: Location
        order: 4
      # Aruba - wlanAPHwVersion
      # Cisco - cLApEntPhysicalIndex + entPhysicalHardwareRev
      hwVersion:
        label: Hardware Version
        short_label: Hardware
        type: string
        order: 20
      # Aruba - wlanAPSwVersion
      # Cisco - bsnAPSoftwareVersion
      swVersion:
        label: Software Version
        short_label: Software
        order: 10
        details_display: false
      # Aruba - wlanAPModelName
      # Cisco - bsnAPModel
      model:
        label: Model
        grid_display: true
        order: 1
        label_width: 115
        content_width: 115
      # Aruba - wlanAPSerialNumber
      # Cisco - bsnAPSerialNumber
      serial:
        label: Serial Number
        short_label: Serial
        order: 2
      # Aruba - wlanAPIpAddress
      # Cisco - bsnApIpAddress
      ip:
        label: IP Address
        grid_display: true
        order: 5
        label_width: 90
        content_width: 90
      # Aruba - wlanAPConfigNetmask
      # Cisco - bsnAPNetmask
      netmask:
        label: Netmask
        order: 6
        details_display: false
      # Aruba - wlanAPConfigGateway
      # Cisco - bsnAPGateway
      gateway:
        label: Default Gateway
        order: 7
        details_display: false
      # Aruba - lldpNeighborSysName
      # Cisco - clcCdpApCacheNeighName
      neighborName:
        label: Neighbor Name
        short_label: Neighbor
        order: 13
      # Aruba - lldpNeighborManAddr
      # Cisco - clcCdpApCacheNeighAddress
      neighborIp:
        label: Neighbor IP Address
        short_label: Neighbor IP
        order: 14
      # Aruba - lldpNeighborPortId
      # Cisco - clcCdpApCacheNeighInterface
      neighborInterface:
        label: Neighbor Interface
        short_label: Neighbor Int
        order: 16

  ArubaAP:
    base: [AccessPoint]
    label: Access Point
    short_label: AP
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # wlanAPUnprovisioned
      provisioned:
        label: Provisioned
        type: boolean
        # Modeler will have invert the value
        enum: {true: "clear", false: "critical"}
        renderer: Zenoss.render.severity
        label_width: 25
        content_width: 25
        details_display: false

  ArubaInstantAP:
    base: [ArubaAP]
    label: Access Point
    short_label: AP

  CiscoAP:
    base: [AccessPoint]
    label: Access Point
    short_label: AP
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # bsnAPBootVersion
      bootVersion:
        label: Boot Version
        short_label: Boot
        order: 21
      # bsnAPAdminStatus
      enabled:
        label: Enabled
        type: boolean
        #enum: {1: "Enabled", 2: "Disabled"}
        enum: {true: "clear", false: "debug"}
        renderer: Zenoss.render.severity
        grid_display: true
        details_display: false
        order: 17
        label_width: 35
        content_width: 35
      # bsnAPIOSVersion
      iosVersion:
        label: IOS Version
        short_label: IOS
        order: 22
      # cLApLinkLatencyEnable
      latency:
        label: Link Latency Measurement
        short_label: Latency
        type: bool
        enum: {true: "clear", false: "critical"}
        renderer: Zenoss.render.severity
        grid_display: true
        details_display: false
        order: 16
        label_width: 35
        content_width: 35
      # bsnAPEthernetMacAddress
      mac:
        label: MAC Address
        short_label: MAC
      # bsnAPMonitorOnlyMode
      mode:
        label: Mode
      # clcCdpApCachePlatform
      neighborModel:
        label: Neighbor Model
        order: 15
      # bsnAPDot3MacAddress
      radioMac:
        label: Base Radio MAC Address
        short_label: Radio MAC

  APGroup:
    label: Access Point Group
    short_label: Group
    relationships:
      accessPoints:
        label_width: 35
        content_width: 35
    properties:
      DEFAULTS:
        type: string
        grid_display: true
        details_display: true
      # Cisco - bsnAPGroupsVlanDescription
      description:
        label: Description
        order: 2
        label_width: 300
        content_width: 300

  APRadio:
    label: Abstract AP Radio
    short_label: Radio
    relationships:
      accessPoint:
        grid_display: false
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # Aruba - wlanAPRadioType
      # Cisco - bsnAPIfType
      band:
        label: Band
        grid_display: true
        order: 2
        label_width: 45
        content_width: 45
      # Aruba - wlanAPExternalAntenna (on AP)
      # Cisco - bsnAPIfPhyAntennaType
      antenna:
        label: Antenna Type
        short_label: Antenna
        order: 6
      # Aruba - wlanAPRadioChannel
      # Cisco - bsnAPIfPhyChannelNumber
      channel:
        label: Channel Number
        short_label: Channel
        grid_display: true
        order: 3
        label_width: 40
        content_width: 40
      # Aruba - wlanAPRadioType + wlanAPRadioHTMode
      # Cisco - bsnAPIfType + cLApDot11nSupport (11ac?)
      dot11:
        label: Radio Type
        short_label: Type
        grid_display: true
        order: 1
        label_width: 50
        content_width: 50
      # Aruba - wlanAPdot11aAntennaGain, wlanAPdot11gAntennaGain (on AP)
      # Cisco - bsnAPIfAntennaGain
      gain:
        label: Antenna Gain (dBm)
        short_label: Gain
        type: float
        order: 7
      # Aruba - wlanAPRadioHTMode
      # Cisco - cLAp11nChannelBandwidth
      width:
        label: Bandwidth
        short_label: Width
        order: 4

  ArubaAPRadio:
    base: [APRadio]
    label: Access Point Radio
    short_label: Radio
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # wlanAPRadioNumAssociatedClients
      clients:
        label: Clients
        short_label: Clients
        type: int
        grid_display: true
        details_display: false
        datapoint: wlanAPRadioNumAssociatedClients_wlanAPRadioNumAssociatedClients
        order: 20
        label_width: 35
        content_width: 35
      # wlanAPRadioUtilization
      channelUtil:
        label: Channel Utilization
        short_label: Util
        type: int
        grid_display: true
        details_display: false
        datapoint: wlanAPRadioUtilization_wlanAPRadioUtilization
        label_width: 35
        content_width: 35

  CiscoAPRadio:
    base: [APRadio]
    label: Access Point Radio
    short_label: Radio
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # bsnAPIfPhyAntennaMode
      mode:
        label: Antenna Mode
        order: 8
      # bsnAPIfPhyChannelAssignment
      assignment:
        label: Channel Assignment
        short_label: Assignment
        order: 5
      # bsnAPIfPhyAntennaDiversity
      diversity:
        label: Antenna Diversity
        short_label: Diversity
        order: 9
      # bsnAPIfAdminStatus
      enabled:
        label: Enabled
        type: boolean
        #enum: {1: "Enabled", 2: "Disabled"}
        enum: {true: "clear", false: "debug"}
        renderer: Zenoss.render.severity
        grid_display: true
        order: 10
        label_width: 35
        content_width: 35
        details_display: false
      # bsnApIfNoOfUsers
      clients:
        label: Clients
        short_label: Clients
        type: int
        grid_display: true
        details_display: false
        datapoint: bsnApIfNoOfUsers_bsnApIfNoOfUsers
        order: 20
        label_width: 35
        content_width: 35

  ArubaRemoteController:
    label: Aruba Controller
    short_label: Controller
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # wlsxSysExtSwitchListEntry indexes
      ip:
        label: IP Address
        short_label: IP
        type: string
        grid_display: true
        label_width: 90
        content_width: 90
      # sysExtSwitchLocation
      location:
        label: Location
        grid_display: true
      # sysExtSwitchSerNo
      serial:
        label: Serial
      # sysExtSwitchStatus
      status:
        label: Status
        type: int
        #enum: {1: "Active", 2: "Inactive"}
        enum: {1: "clear", 2: "critical"}
        renderer: Zenoss.render.severity
        grid_display: true
        details_display: false
      # sysExtSwitchSWVersion
      swVersion:
        label: Software Version
        short_label: OS
        grid_display: false

  ArubaLocalController:
    base: [ArubaRemoteController]
    label: Local Controller
    short_label: Local

  ArubaMasterController:
    base: [ArubaRemoteController]
    label: Master Controller
    plural_label: Master Controller
    short_label: Master
    plural_short_label: Master

  # Aruba does not report on this via SNMP
  DHCPPool:
    label: DHCP Pool
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # Cisco - agentDhcpScopeDnsServerAddress(1|2|3)
      dns:
        label: DNS Servers
        short_label: DNS
        type: lines
        order: 6
      # Cisco - agentDhcpScopeDnsDomainName
      domain:
        label: DNS Domain
        short_label: Domain
        order: 7
      # Cisco - agentDhcpScopeState
      enabled:
        label: Enabled
        type: bool
        enum: {true: "clear", false: "debug"}
        renderer: Zenoss.render.severity
        grid_display: true
        details_display: false
        order: 10
        label_width: 35
        content_width: 35
      # Cisco - agentDhcpScopePoolEndAddress
      end:
        label: Ending IP Address
        short_label: End IP
        grid_display: true
        order: 2
        label_width: 90
        content_width: 90
      # Cisco - agentDhcpScopeNetwork, agentDhcpScopeNetmask
      network:
        label: Network
        grid_display: true
        order: 3
        label_width: 90
        content_width: 90
      # Cisco - agentDhcpScopeDefaultRouterAddress(1|2|3)
      routers:
        label: Default Gateways
        short_label: Gateways
        type: lines
        order: 5
      # Cisco - agentDhcpScopePoolStartAddress
      start:
        label: Starting IP Address
        short_label: Start IP
        grid_display: true
        order: 1
        label_width: 90
        content_width: 90

  # Should this extend Products.ZenModel.Software?
  License:
    label: License
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # Aruba - licenseService (colon split)
      # Cisco - clmgmtLicenseMaxUsageCount
      count:
        label: Count
        type: int
        grid_display: true
      # Aruba - sysExtLicenseExpires
      # Cisco - clmgmtLicenseValidityPeriodRemaining (calculate)
      expiration:
        label: Expiration Date
        short_label: Expiration
      # Aruba - sysExtLicenseFlags
      #         E - enabled
      #         A - auto-generated
      #         R - reboot required
      # Cisco - clmgmtLicenseStatus
      #         1 - inactive
      #         2 - not in use
      #         3 - in use
      #         4 - expired, in use
      #         5 - expired, not in use
      #         6 - usage count consumed
      status:
        label: Status
      statusSev:
        label: Status
        enum:
          E: "clear"
          A: "clear"
          R: "warning"
          1: "debug"
          2: "debug"
          3: "clear"
          4: "critical"
          5: "debug"
          6: "critical"
        renderer: Zenoss.render.severity
        grid_display: true
        details_display: false

  # "VLANs" on Aruba
  # "Interfaces" on Cisco WLC (physical interfaces are "ports")
  # Should this extend Products.ZenModel.IpInterface?
  VlanInterface:
    label: VLAN Interface
    short_label: VLAN
    properties:
      DEFAULTS:
        type: string
        grid_display: true
        details_display: true
      # Aruba - ifExtVlanInterfaceIpAddress + ifExtVlanInterfaceIpMask
      # Cisco - agentInterfaceIPAddress + agentInterfaceIPNetmask
      ip:
        label: IP Address
        short_label: IP
        order: 2
        label_width: 90
        content_width: 90
      # Aruba does not appear to report the MAC
      # Cisco - agentInterfaceMacAddress
      mac:
        label: MAC Address
        short_label: MAC
        order: 4
        label_width: 90
        content_width: 90
      # Aruba - wlsxIfExtVlanEntry indexes
      # Cisco - agentInterfaceVlanId
      vlan:
        label: VLAN
        type: int
        order: 1
        label_width: 25
        content_width: 25

  AAAServer:
    label: AAA Server
    short_label: AAA
    properties:
      DEFAULTS:
        grid_display: false
        details_display: true
      # Aruba - authServerInservice, authServerState?
      enabled:
        label: Enabled
        type: bool
        enum: {true: "clear", false: "debug"}
        renderer: Zenoss.render.severity
        grid_display: true
        details_display: false
        order: 10
        label_width: 35
        content_width: 35
      # Aruba - authServerAddress
      ip:
        label: IP Address
        short_label: IP
        type: string
        order: 1
        label_width: 80
        content_width: 80
      # Aruba - authServerPort
      port:
        label: Port
        type: int
        order: 2
        label_width: 35
        content_width: 35

  # Cisco doesn't appear to report stats on this
  InternalDB:
    base: [AAAServer]
    label: Internal User Database
    short_label: Internal DB
    properties:
      port:
        grid_display: false
        details_display: false

  LDAPServer:
    base: [AAAServer]
    label: LDAP Server
    short_label: LDAP
    # enabled
    # Cisco - cldlServerState
    # ip
    # Cisco - cldlServerAddress
    # port
    # Cisco - cldlServerPortNum
    #properties:
    #  DEFAULTS:
    #    type: string
    #    grid_display: false
    #    details_display: true
    #  baseDN:
    #    label: Base DN
    #    short_label: Base
    #    order: 5
    #  user:
    #    label: Bind User 
    #    short_label: Bind
    #    order: 7
    #  userAttr:
    #    label: User Attribute
    #    short_label: Attribute
    #    order: 6

  RadiusServer:
    base: [AAAServer]
    label: RADIUS Server
    short_label: RADIUS

  RadAcctServer:
    base: [RadiusServer]
    label: RADIUS Accounting Server
    short_label: RADIUS Acct
    # enabled
    # Cisco - bsnRadiusAccServerStatus
    # ip
    # Cisco - bsnRadiusAccServerAddress
    # port
    # Cisco - bsnRadiusAccClientServerPortNumber

  RadAuthServer:
    base: [RadiusServer]
    label: RADIUS Authentication Server
    short_label: RADIUS Auth
    # enabled
    # Cisco - bsnRadiusAuthServerStatus
    # ip
    # Cisco - bsnRadiusAuthServerAddress
    # port
    # Cisco - bsnRadiusAuthClientServerPortNumber

  # Not supported for WLAN auth on Cisco, only management
  # Stats not available on Cisco
  TacacsServer:
    base: [AAAServer]
    label: TACACS Server
    short_label: TACACS
    # enabled
    # Cisco - claTacacsServerEnabled.(type)
    #         1 - authn
    #         2 - authz
    #         3 - acct
    # ip
    # Cisco - claTacacsServerAddress.(type)
    # port
    # Cisco - claTacacsServerPortNum.(type)

  TacAcctServer:
    base: [TacacsServer]
    label: TACACS Accounting Server
    short_label: TACACS Acct

  TacAuthnServer:
    base: [TacacsServer]
    label: TACACS Authentication Server
    short_label: TACACS Authn

  # Unknown if supported on Aruba
  TacAuthzServer:
    base: [TacacsServer]
    label: TACACS Authorization Server
    short_label: TACACS Authz

  # Not supported on Cisco
  WindowsServer:
    base: [AAAServer]
    label: Windows Server
    short_label: Windows

  WLAN:
    label: Abstract WLAN
    short_label: WLAN
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # Aruba - wlanESSIDEncryptionType
      # Cisco - cLWSecDot11EssCckmTable
      #         + cLWSecDot11EssCkipEntry
      #         + bsnDot11EssWebSecurity
      #         + bsnDot11EssStaticWEPSecurity
      #         + bsnDot11Ess8021xSecurity
      security:
        label: Security
        short_label: Security
        grid_display: true
        order: 5
        # To fit "WPA-TKIP/WPA2-AES+TKIP PSK + WebAuth + MAC Filter" at max
        label_width: 285
        content_width: 285
      # Aruba - indexes of WlanESSIDEntry
      # Cisco - cLWlanSsid, bsnDot11EssSsid
      ssid:
        label: SSID
        order: 1

  ArubaWLAN:
    base: [WLAN]
    label: Wireless LAN
    short_label: WLAN
    properties:
      DEFAULTS:
        type: int
        grid_display: true
        details_display: true
      # wlanESSIDNumAccessPointsUp
      accessPoints:
        label: Access Points
        short_label: APs
        datapoint: wlanESSIDNumAccessPointsUp_wlanESSIDNumAccessPointsUp
        label_width: 35
        content_width: 35
      # wlanESSIDNumStations
      clients:
        label: Clients
        datapoint: wlanESSIDNumStations_wlanESSIDNumStations
        label_width: 35
        content_width: 35

  CiscoWLAN:
    base: [WLAN]
    label: Wireless LAN
    short_label: WLAN
    properties:
      DEFAULTS:
        grid_display: false
        details_display: true
      # bsnDot11EssBroadcastSsid
      broadcast:
        label: Broadcast
        type: boolean
        enum: {true: "clear", false: "debug"}
        renderer: Zenoss.render.severity
        grid_display: true
        details_display: false
        order: 6
        label_width: 45
        content_width: 45
      # bsnDot11EssNumberOfMobileStations
      clients:
        label: Clients
        type: int
        datapoint: bsnDot11EssNumberOfMobileStations_bsnDot11EssNumberOfMobileStations
        grid_display: true
        order: 8
        label_width: 35
        content_width: 35
      # bsnDot11EssDhcpServerIpAddress
      dhcp:
        label: DHCP Server
        short_label: DHCP
        type: string
        order: 13
      # bsnDot11EssAdminStatus
      enabled:
        label: Enabled
        type: boolean
        enum: {true: "clear", false: "debug"}
        renderer: Zenoss.render.severity
        grid_display: true
        details_display: false
        order: 7
        label_width: 35
        content_width: 35
      # cldlWlanLdap(Primary|Secondary|Teriary)ServerIndex
      ldap:
        label: LDAP Servers
        short_label: LDAP
        type: lines
        order: 12
      # cLWlanProfileName
      profile:
        label: Profile
        type: string
        order: 2
      # bsnDot11EssRadiusAcct(Primary|Secondary|Tertiary)Server
      radAcct:
        label: RADIUS Accounting Servers
        short_label: RADIUS Acct
        type: lines
        order: 11
      # bsnDot11EssRadiusAuth(Primary|Secondary|Tertiary)Server
      radAuth:
        label: RADIUS Authentication Servers
        short_label: RADIUS Auth
        type: lines
        order: 10
 
  # cLWlanLanSubType, cLWlanIsWired
  CiscoGuestLAN:
    base: [CiscoWLAN]
    label: Guest LAN
    properties:
      broadcast:
        type: boolean
        grid_display: false
      ssid:
        type: string
        details_display: false

  # cLWlanLanSubType
  CiscoRemoteLAN:
    base: [CiscoWLAN]
    label: Remote LAN
    properties:
      broadcast:
        type: boolean
        grid_display: false
      # This does not hide SSID from the details display...?
      ssid:
        type: string
        details_display: false


zProperties:
  DEFAULTS:
    category: WLAN
  zWlanApClientThreshold:
    type: int
    default: 64
  zWlanApGroupIgnoreNames:
    type: string
  zWlanApIgnoreNames:
    type: string
  zWlanApIgnoreSubnets:
    type: lines
  zWlanApIgnoreModels:
    type: lines
  zWlanDhcpIgnoreNames:
    type: string
  zWlanDhcpIgnoreSubnets:
    type: lines
  zWlanInterfaceIgnoreNames:
    type: string
  zWlanInterfaceIgnoreSubnets:
    type: lines
  zWlanInterfaceIgnoreVlans:
    type: lines
  zWlanServerIgnoreNames:
    type: string
  zWlanServerIgnoreSubnets:
    type: lines
  zWlanServerIgnoreTypes:
    type: lines
  zWlanWlanIgnoreNames:
    type: string


device_classes:
  /Network/Aruba/Controller:
    remove: true
    zProperties:
      zCollectorPlugins:
        - zenoss.snmp.DeviceMap
        - zenoss.snmp.InterfaceMap
        - zenoss.snmp.RouteMap
        - zenoss.snmp.SnmpV3EngineIdMap
        - daviswr.snmp.ArubaControllerDevice
        - daviswr.snmp.ArubaControllerAAA
        - daviswr.snmp.ArubaControllerAP
        - daviswr.snmp.ArubaControllerCPU
        - daviswr.snmp.ArubaControllerFan
        - daviswr.snmp.ArubaControllerLicense
        - daviswr.snmp.ArubaControllerMasterLocal
        - daviswr.snmp.ArubaControllerPowerSupply
        - daviswr.snmp.ArubaControllerTemperature
        - daviswr.snmp.ArubaControllerVLAN
        - daviswr.snmp.ArubaControllerWLAN
      zPythonClass: ZenPacks.daviswr.WirelessController.ArubaController


  # To avoid conflict with /Network/Cisco/WLC from the Enterprise ZenPacks
  /Network/Cisco/Controller:
    remove: true
    zProperties:
      zCollectorPlugins:
        - zenoss.snmp.DeviceMap
        - zenoss.snmp.InterfaceMap
        - zenoss.snmp.RouteMap
        - zenoss.snmp.SnmpV3EngineIdMap
        - daviswr.snmp.CiscoControllerDevice
        - daviswr.snmp.CiscoControllerAAA
        - daviswr.snmp.CiscoControllerAP
        - daviswr.snmp.CiscoControllerDHCPPool
        - daviswr.snmp.CiscoControllerLicense
        - daviswr.snmp.CiscoControllerTemperature
        - daviswr.snmp.CiscoControllerVLAN
        - daviswr.snmp.CiscoControllerWLAN
      zPythonClass: ZenPacks.daviswr.WirelessController.CiscoController
      # AireOS does not report stats for LDAP or TACACS servers
      zWlanServerIgnoreTypes:
        - ldap
        - tacacs

    templates:
      # /Network/Cisco/Controller/Device
      Device:
        description: CPU & memory utilization from AIRESPACE-SWITCHING-MIB
        targetPythonClass: ZenPacks.daviswr.WirelessController.CiscoController
        datasources:
          DEFAULTS:
            type: SNMP
          agentCurrentCPUUtilization:
            oid: .1.3.6.1.4.1.14179.1.1.5.1.0
            datapoints:
              agentCurrentCPUUtilization:
                description: Current CPU Load of the switch in percentage
                rrdtype: GAUGE
                aliases:
                  # Compatibility with Zenoss CPU Utilization report
                  # https://monitoringartist.github.io/community.zenoss.org/docs/DOC-3025.html
                  cpu_pct: "0,+"
          agentFreeMemory:
            oid: .1.3.6.1.4.1.14179.1.1.5.3.0
            datapoints:
              agentFreeMemory:
                description: Free RAM of the switch in Kbytes
                rrdtype: GAUGE
                aliases:
                  freeMemory: "1024,*"
                  usedMemory: "-1024,*,${here/hw/totalMemory},+"
                  mem_pct: "-1024,*,${here/hw/totalMemory},+,${here/hw/totalMemory},/,100,*"
          sysUpTime:
            oid: .1.3.6.1.2.1.1.3.0
            datapoints:
              sysUpTime:
                description: The time (in hundredths of a second) since the network management portion of the system was last re-initialized
                rrdtype: GAUGE
        graphs:
          DEFAULTS:
            height: 100
            width: 500
            miny: 0
          Controller CPU:
            units: percentage
            maxy: 100
            graphpoints:
              Utilization:
                dpName: agentCurrentCPUUtilization_agentCurrentCPUUtilization
                lineType: AREA
                stacked: true
                colorindex: 0
          Controller Memory:
            units: bytes
            base: true
            graphpoints:
              DEFAULTS:
                dpName: agentFreeMemory_agentFreeMemory
                lineType: AREA
                stacked: true
              Used:
                rpn: "-1024,*,${here/hw/totalMemory},+"
                colorindex: 0
              Free:
                rpn: "1024,*"
                color: cccccc

      # /Network/Cisco/Controller/AccessPoint
      AccessPoint:
        description: Access point link stats from CISCO-LWAPP-AP-MIB
        targetPythonClass: ZenPacks.daviswr.WirelessController.CiscoAP
        datasources:
          DEFAULTS:
            type: SNMP
          cLApDataLinkLatencyStatsCurrent:
            oid: .1.3.6.1.4.1.9.9.513.1.5.2.1.5
            datapoints:
              cLApDataLinkLatencyStatsCurrent:
                description: The current Data Link latency recorded for this Access point
                rrdtype: GAUGE
          cLApLinkLatencyStatsCurrent:
            oid: .1.3.6.1.4.1.9.9.513.1.5.2.1.1
            datapoints:
              cLApLinkLatencyStatsCurrent:
                description: The current Link latency recorded for this Access point
                rrdtype: GAUGE
        graphs:
          DEFAULTS:
            height: 100
            width: 500
          Latency:
            miny: 0
            units: milliseconds
            graphpoints:
              Link:
                dpName: cLApLinkLatencyStatsCurrent_cLApLinkLatencyStatsCurrent
                lineType: AREA
                colorindex: 0
              Data Link:
                dpName: cLApDataLinkLatencyStatsCurrent_cLApDataLinkLatencyStatsCurrent
                lineType: LINE
                lineWidth: 2
                colorindex: 1

      # /Network/Cisco/Controller/AccessPointRadio
      AccessPointRadio:
        description: Radio stats from AIRESPACE-WIRELESS-MIB
        targetPythonClass: ZenPacks.daviswr.WirelessController.CiscoWLAN
        datasources:
          DEFAULTS:
            type: SNMP
          bsnAPIfLoadChannelUtilization:
            oid: .1.3.6.1.4.1.14179.2.2.13.1.3
            datapoints:
              bsnAPIfLoadChannelUtilization:
                description: Channel Utilization
                rrdtype: GAUGE
          bsnAPIfLoadNumOfClients:
            oid: .1.3.6.1.4.1.14179.2.2.13.1.4
            datapoints:
              bsnAPIfLoadNumOfClients:
                description: This is the number of clients attached to this Airespace AP
                rrdtype: GAUGE
          bsnAPIfLoadRxUtilization:
            oid: .1.3.6.1.4.1.14179.2.2.13.1.1
            datapoints:
              bsnAPIfLoadRxUtilization:
                description: This is the percentage of time the Airespace AP receiver is busy operating on packets
                rrdtype: GAUGE
          bsnAPIfLoadTxUtilization:
            oid: .1.3.6.1.4.1.14179.2.2.13.1.2
            datapoints:
              bsnAPIfLoadTxUtilization:
                description: This is the percentage of time the Airespace AP transmitter is busy operating on packets
                rrdtype: GAUGE
          bsnApIfNoOfUsers:
            oid: .1.3.6.1.4.1.14179.2.2.2.1.15
            datapoints:
              bsnApIfNoOfUsers:
                description: No. of Users associated with this radio
                rrdtype: GAUGE
          bsnAPIfNumberOfVaps:
            oid: .1.3.6.1.4.1.14179.2.2.2.1.11
            datapoints:
              bsnAPIfNumberOfVaps:
                description: Number of WLANs currently active on this AP Interface
                rrdtype: GAUGE
          bsnAPIfOperStatus:
            oid: .1.3.6.1.4.1.14179.2.2.2.1.12
            datapoints:
              bsnAPIfOperStatus:
                description: Operational status of the interface
                rrdtype: GAUGE
          bsnAPIfPhyTxPowerLevel:
            oid: .1.3.6.1.4.1.14179.2.2.2.1.6
            datapoints:
              bsnAPIfPhyTxPowerLevel:
                description: The TxPowerLevel currently being used to transmit data
                rrdtype: GAUGE
          bsnAPIfPoorSNRClients:
            oid: .1.3.6.1.4.1.14179.2.2.13.1.24
            datapoints:
              bsnAPIfPoorSNRClients:
                description: This is the number of clients with poor SNR attached to this Airespace AP
                rrdtype: GAUGE
        thresholds:
          DEFAULTS:
            enabled: true
          Operational Status:
            type: ValueChangeThreshold
            severity: 2
            # Subclass TDB
            eventClass: /Status/Perf
            dsnames:
              - bsnAPIfOperStatus_bsnAPIfOperStatus
        graphs:
          DEFAULTS:
            height: 100
            width: 500
            miny: 0
          Associations:
            units: clients
            graphpoints:
              Clients:
                dpName: bsnAPIfLoadNumOfClients_bsnAPIfLoadNumOfClients
                lineType: AREA
                colorindex: 0
              Poor-SNR Clients:
                dpName: bsnAPIfPoorSNRClients_bsnAPIfPoorSNRClients
                lineType: LINE
                lineWidth: 1
                colorindex: 1
          Load:
            maxy: 100
            units: percentage
            graphpoints:
              Receive:
                dpName: bsnAPIfLoadRxUtilization_bsnAPIfLoadRxUtilization
                lineType: AREA
                colorindex: 0
              Transmit:
                dpName: bsnAPIfLoadTxUtilization_bsnAPIfLoadTxUtilization
                lineType: LINE
                lineWidth: 1
                colorindex: 1
          Channel Utilization:
            maxy: 100
            units: percentage
            graphpoints:
              Utilization:
                dpName: bsnAPIfLoadChannelUtilization_bsnAPIfLoadChannelUtilization
                lineType: AREA
                colorindex: 0
          WLANs:
            units: WLANs
            graphpoints:
              WLANs:
                dpName: bsnAPIfNumberOfVaps_bsnAPIfNumberOfVaps
                lineType: LINE
                lineWidth: 2
                colorindex: 0
          Power Level:
            graphpoints:
              Level:
                dpName: bsnAPIfPhyTxPowerLevel_bsnAPIfPhyTxPowerLevel
                lineType: LINE
                lineWidth: 2
                colorindex: 0

      # /Network/Cisco/Controller/RADIUSAccountingServer
      RADIUSAccountingServer:
        description: RADIUS accounting stats from AIRESPACE-WIRELESS-MIB
        targetPythonClass: ZenPacks.daviswr.WirelessController.RadAcctServer
        datasources:
          DEFAULTS:
            type: SNMP
          bsnRadiusAccClientRoundTripTime:
            oid: .1.3.6.1.4.1.14179.2.5.4.1.6
            datapoints:
              bsnRadiusAccClientRoundTripTime:
                description: The time interval between the most recent Accounting-Response and the Accounting-Request that matched it
                rrdtype: GAUGE
          bsnRadiusAccClientRequests:
            oid: .1.3.6.1.4.1.14179.2.5.4.1.7
            datapoints:
              bsnRadiusAccClientRequests:
                description: The number of RADIUS Accounting-Request packets sent. This does not include retransmissions.
                rrdtype: DERIVE
                rrdmin: 0
          bsnRadiusAccClientRetransmissions:
            oid: .1.3.6.1.4.1.14179.2.5.4.1.8
            datapoints:
              bsnRadiusAccClientRetransmissions:
                description: The number of RADIUS Accounting-Request packets retransmitted
                rrdtype: DERIVE
                rrdmin: 0
          bsnRadiusAccClientResponses:
            oid: .1.3.6.1.4.1.14179.2.5.4.1.9
            datapoints:
              bsnRadiusAccClientResponses:
                description: The number of RADIUS packets received on the accounting port
                rrdtype: DERIVE
                rrdmin: 0
          bsnRadiusAccClientMalformedResponses:
            oid: .1.3.6.1.4.1.14179.2.5.4.1.10
            datapoints:
              bsnRadiusAccClientMalformedResponses:
                description: The number of malformed RADIUS Accounting-Response packets received. Bad authenticators and unknown types are not included
                rrdtype: DERIVE
                rrdmin: 0
          bsnRadiusAccClientBadAuthenticators:
            oid: .1.3.6.1.4.1.14179.2.5.4.1.11
            datapoints:
              bsnRadiusAccClientBadAuthenticators:
                description: The number of RADIUS Accounting-Response packets which contained invalid authenticators received
                rrdtype: DERIVE
                rrdmin: 0
          bsnRadiusAccClientPendingRequests:
            oid: .1.3.6.1.4.1.14179.2.5.4.1.12
            datapoints:
              bsnRadiusAccClientPendingRequests:
                description: The number of RADIUS Accounting-Request packets sent that have not yet timed out or received a response.
                rrdtype: GAUGE
          bsnRadiusAccClientTimeouts:
            oid: .1.3.6.1.4.1.14179.2.5.4.1.13
            datapoints:
              bsnRadiusAccClientTimeouts:
                description: The number of accounting timeouts to this server.
                rrdtype: DERIVE
                rrdmin: 0
          bsnRadiusAccClientUnknownTypes:
            oid: .1.3.6.1.4.1.14179.2.5.4.1.14
            datapoints:
              bsnRadiusAccClientUnknownTypes:
                description: The number of RADIUS packets of unknown type which were received
                rrdtype: DERIVE
                rrdmin: 0
          bsnRadiusAccClientPacketsDropped:
            oid: .1.3.6.1.4.1.14179.2.5.4.1.34
            datapoints:
              bsnRadiusAccClientPacketsDropped:
                description: The number of RADIUS packets which were received and dropped for some other reason.
                rrdtype: DERIVE
                rrdmin: 0
        graphs:
          DEFAULTS:
            height: 100
            width: 500
            miny: 0
          Round Trip Time:
            units: milliseconds
            graphpoints:
              Time:
                dpName: bsnRadiusAccClientRoundTripTime_bsnRadiusAccClientRoundTripTime
                lineType: AREA
                colorindex: 0
          Activity:
            units: requests/sec
            graphpoints:
              Requests:
                dpName: bsnRadiusAccClientRequests_bsnRadiusAccClientRequests
                lineType: LINE
                lineWidth: 2
                colorindex: 0
              Retransmissions:
                dpName: bsnRadiusAccClientRetransmissions_bsnRadiusAccClientRetransmissions
                lineType: LINE
                lineWidth: 2
                colorindex: 1
              Responses:
                dpName: bsnRadiusAccClientResponses_bsnRadiusAccClientResponses
                lineType: LINE
                lineWidth: 2
                colorindex: 2
          Errors:
            units: requests/sec
            graphpoints:
              Malformed:
                dpName: bsnRadiusAccClientMalformedResponses_bsnRadiusAccClientMalformedResponses
                lineType: LINE
                lineWidth: 2
                colorindex: 0
              Bad Auth:
                dpName: bsnRadiusAccClientBadAuthenticators_bsnRadiusAccClientBadAuthenticators
                lineType: LINE
                lineWidth: 2
                colorindex: 1
              Timeout:
                dpName: bsnRadiusAccClientTimeouts_bsnRadiusAccClientTimeouts
                lineType: LINE
                lineWidth: 2
                colorindex: 2
              Unknown:
                dpName: bsnRadiusAccClientUnknownTypes_bsnRadiusAccClientUnknownTypes
                lineType: LINE
                lineWidth: 2
                colorindex: 3
              Dropped:
                dpName: bsnRadiusAccClientPacketsDropped_bsnRadiusAccClientPacketsDropped
                lineType: LINE
                lineWidth: 2
                colorindex: 4
          Pending Requests:
            units: requests
            graphpoints:
              Pending:
                dpName: bsnRadiusAccClientPendingRequests_bsnRadiusAccClientPendingRequests
                lineType: AREA
                colorindex: 0

      # /Network/Cisco/Controller/RADIUSAuthenticationServer
      RADIUSAuthenticationServer:
        description: RADIUS authentication stats from AIRESPACE-WIRELESS-MIB
        targetPythonClass: ZenPacks.daviswr.WirelessController.RadAuthServer
        datasources:
          DEFAULTS:
            type: SNMP
          bsnRadiusAuthClientRoundTripTime:
            oid: .1.3.6.1.4.1.14179.2.5.3.1.6
            datapoints:
              bsnRadiusAuthClientRoundTripTime:
                description: The time interval (in hundredths of a second) between the most recent Access-Reply/Access-Challenge and the Access-Request that matched it
                rrdtype: GAUGE
          bsnRadiusAuthClientAccessRequests:
            oid: .1.3.6.1.4.1.14179.2.5.3.1.7
            datapoints:
              bsnRadiusAuthClientAccessRequests:
                description: The number of RADIUS Access-Request packets sent. This does not include retransmissions.
                rrdtype: DERIVE
                rrdmin: 0
          bsnRadiusAuthClientAccessRetransmissions:
            oid: .1.3.6.1.4.1.14179.2.5.3.1.8
            datapoints:
              bsnRadiusAuthClientAccessRetransmissions:
                description: The number of RADIUS Access-Request packets retransmitted
                rrdtype: DERIVE
                rrdmin: 0
          bsnRadiusAuthClientAccessAccepts:
            oid: .1.3.6.1.4.1.14179.2.5.3.1.9
            datapoints:
              bsnRadiusAuthClientAccessAccepts:
                description: The number of RADIUS Access-Accept packets (valid or invalid) received
                rrdtype: DERIVE
                rrdmin: 0
          bsnRadiusAuthClientAccessRejects:
            oid: .1.3.6.1.4.1.14179.2.5.3.1.10
            datapoints:
              bsnRadiusAuthClientAccessRejects:
                description: The number of RADIUS Access-Reject packets (valid or invalid) received
                rrdtype: DERIVE
                rrdmin: 0
          bsnRadiusAuthClientAccessChallenges:
            oid: .1.3.6.1.4.1.14179.2.5.3.1.11
            datapoints:
              bsnRadiusAuthClientAccessChallenges:
                description: The number of RADIUS Access-Challenge packets (valid or invalid)
                rrdtype: DERIVE
                rrdmin: 0
          bsnRadiusAuthClientMalformedAccessResponses:
            oid: .1.3.6.1.4.1.14179.2.5.3.1.12
            datapoints:
              bsnRadiusAuthClientMalformedAccessResponses:
                description: The number of malformed RADIUS Access-Response packets received. Bad authenticators or Signature attributes or unknown types are not included
                rrdtype: DERIVE
                rrdmin: 0
          bsnRadiusAuthClientBadAuthenticators:
            oid: .1.3.6.1.4.1.14179.2.5.3.1.13
            datapoints:
              bsnRadiusAuthClientBadAuthenticators:
                description: The number of RADIUS Access-Response packets containing invalid authenticators or Signature attributes received
                rrdtype: DERIVE
                rrdmin: 0
          bsnRadiusAuthClientPendingRequests:
            oid: .1.3.6.1.4.1.14179.2.5.3.1.14
            datapoints:
              bsnRadiusAuthClientPendingRequests:
                description: The number of RADIUS Access-Request packets destined for this server that have not yet timed out or received a response
                rrdtype: GAUGE
          bsnRadiusAuthClientTimeouts:
            oid: .1.3.6.1.4.1.14179.2.5.3.1.15
            datapoints:
              bsnRadiusAuthClientTimeouts:
                description: The number of authentication timeouts to this server.
                rrdtype: DERIVE
                rrdmin: 0
          bsnRadiusAuthClientUnknownTypes:
            oid: .1.3.6.1.4.1.14179.2.5.3.1.16
            datapoints:
              bsnRadiusAuthClientUnknownTypes:
                description: The number of RADIUS packets of unknown type which were received
                rrdtype: DERIVE
                rrdmin: 0
          bsnRadiusAuthClientPacketsDropped:
            oid: .1.3.6.1.4.1.14179.2.5.3.1.36
            datapoints:
              bsnRadiusAuthClientPacketsDropped:
                description: The number of RADIUS packets of which were received and dropped for some other reason.
                rrdtype: DERIVE
                rrdmin: 0
        graphs:
          DEFAULTS:
            height: 100
            width: 500
            miny: 0
          Round Trip Time:
            units: milliseconds
            graphpoints:
              Time:
                dpName: bsnRadiusAuthClientRoundTripTime_bsnRadiusAuthClientRoundTripTime
                lineType: AREA
                colorindex: 0
          Activity:
            units: requests/sec
            graphpoints:
              Requests:
                dpName: bsnRadiusAuthClientAccessRequests_bsnRadiusAuthClientAccessRequests
                lineType: LINE
                lineWidth: 2
                colorindex: 0
              Retransmissions:
                dpName: bsnRadiusAuthClientAccessRetransmissions_bsnRadiusAuthClientAccessRetransmissions
                lineType: LINE
                lineWidth: 2
                colorindex: 1
              Challenges:
                dpName: bsnRadiusAuthClientAccessChallenges_bsnRadiusAuthClientAccessChallenges
                lineType: LINE
                lineWidth: 2
                colorindex: 2
              Accept:
                dpName: bsnRadiusAuthClientAccessAccepts_bsnRadiusAuthClientAccessAccepts
                lineType: LINE
                lineWidth: 2
                colorindex: 3
              Reject:
                dpName: bsnRadiusAuthClientAccessRejects_bsnRadiusAuthClientAccessRejects
                lineType: LINE
                lineWidth: 2
                colorindex: 4
          Errors:
            units: requests/sec
            graphpoints:
              Malformed:
                dpName: bsnRadiusAuthClientMalformedAccessResponses_bsnRadiusAuthClientMalformedAccessResponses
                lineType: LINE
                lineWidth: 2
                colorindex: 0
              Bad Auth:
                dpName: bsnRadiusAuthClientBadAuthenticators_bsnRadiusAuthClientBadAuthenticators
                lineType: LINE
                lineWidth: 2
                colorindex: 1
              Timeout:
                dpName: bsnRadiusAuthClientTimeouts_bsnRadiusAuthClientTimeouts
                lineType: LINE
                lineWidth: 2
                colorindex: 2
              Unknown:
                dpName: bsnRadiusAuthClientUnknownTypes_bsnRadiusAuthClientUnknownTypes
                lineType: LINE
                lineWidth: 2
                colorindex: 3
              Dropped:
                dpName: bsnRadiusAuthClientPacketsDropped_bsnRadiusAuthClientPacketsDropped
                lineType: LINE
                lineWidth: 2
                colorindex: 4
          Pending Requests:
            units: requests
            graphpoints:
              Pending:
                dpName: bsnRadiusAuthClientPendingRequests_bsnRadiusAuthClientPendingRequests
                lineType: AREA
                colorindex: 0

      # /Network/Cisco/Controller/TemperatureSensor
      TemperatureSensor:
        description: System temperature from AIRESPACE-WIRELESS-MIB
        targetPythonClass: Products.ZenModel.TemperatureSensor
        datasources:
          bsnSensorTemperature:
            type: SNMP
            oid: .1.3.6.1.4.1.14179.2.3.1.13
            datapoints:
              # Datapoint name for compatibility with
              # Products.ZenModel.TemperatureSensor class
              temperature_celsius:
                description: Current Internal Temperature of the unit in Centigrade
                rrdtype: GAUGE
                aliases:
                  temperature_fahrenheit: "9,*,5,/,32,+"
        graphs:
          DEFAULTS:
            height: 100
            width: 500
          Celsius:
            units: deg. C
            graphpoints:
              Degrees:
                dpName: bsnSensorTemperature_temperature_celsius
                lineType: LINE
                lineWidth: 2
                colorindex: 0
          Fahrenheit:
            units: deg. F
            graphpoints:
              Degrees:
                dpName: bsnSensorTemperature_temperature_celsius
                lineType: LINE
                lineWidth: 2
                rpn: "9,*,5,/,32,+"
                colorindex: 0

      # /Network/Cisco/Controller/WirelessLAN
      WirelessLAN:
        description: Association count from AIRESPACE-WIRELESS-MIB
        targetPythonClass: ZenPacks.daviswr.WirelessController.CiscoWLAN
        datasources:
          DEFAULTS:
            type: SNMP
          bsnDot11EssNumberOfMobileStations:
            oid: .1.3.6.1.4.1.14179.2.1.1.1.38
            datapoints:
              bsnDot11EssNumberOfMobileStations:
                description: No. of Mobile Stations currently associated with the WLAN
                rrdtype: GAUGE
        graphs:
          DEFAULTS:
            height: 100
            width: 500
          Associations:
            miny: 0
            units: clients
            graphpoints:
              DEFAULTS:
                lineType: AREA
              Clients:
                dpName: bsnDot11EssNumberOfMobileStations_bsnDot11EssNumberOfMobileStations
                colorindex: 0
