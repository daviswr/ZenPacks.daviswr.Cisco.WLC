name: ZenPacks.daviswr.WirelessController

class_relationships:
  - Controller(aaaServers) 1:MC AAAServer(controller)
  - Controller(apGroups) 1:MC APGroup(controller)
  - Controller(dhcpPools) 1:MC DHCPPool(controller)
  - Controller(license) 1:MC License(controller)
  - Controller(vlanInterfaces) 1:MC vlanInterface(controller)
  - Controller(wlans) 1:MC WLAN(controller)
  - APGroup(accessPoints) 1:MC AccessPoint(apGroup)
  - AccessPoint(apRadios) 1:MC APRadio(accessPoint)
  # Aruba-specific
  - ArubaController(arubaRemoteController) 1:MC ArubaRemoteController(controller)
  # Use stock component classes for CPU, fan, and power
  # Non-containing relationships
  #- WLAN(aaaServers) M:M AAAServer(wlans)


classes:
  DEFAULTS:
    base: [zenpacklib.Component]

  Controller:
    base: [zenpacklib.Device]
    label: Wireless Controller
    short_label: Controller
    properties:
      # Aruba - wlsxSysExtHwVersion.0
      # Cisco - entPhysicalHardwareRev.1
      hwVersion:
        type: string
      # Set by license modeler
      maxAPs:
        type: int
      # Aruba - mobilityDomainName ("default" has no Name entry)
      # Cisco - bsnRFMobilityDomainName
      mobilityDomains:
        type: lines
      # Cisco - agentInventoryMaxNumberOfAPsSupported 
      platformMaxAPs:
        type: int
      # Aruba - wlsxSwitchRole
      # Cisco - Check licenses to determine if HA SKU?
      role:
        type: string

  ArubaController:
    base: [Controller]
    label: Aruba Mobility Controller
    short_label: Aruba Controller
    properties:
      isLocal:
        type: boolean
      isMaster:
        type: boolean
      # wlsxSwitchMasterIp
      masterIP:
        type: string

  ArubaInstantController:
    base: [ArubaController]
    label: Aruba Instant Virtual Controller
    short_label: Aruba Instant
    
  CiscoController:
    base: [Controller]
    label: Cisco Wireless LAN Controller
    short_label: Cisco WLC

  CiscoIOSController:
    base: [CiscoController]
    label: Cisco IOS Wireless Controller
    short_label: Cisco IOS WLC
      
  AccessPoint:
    label: Access Point
    short_label: AP
    relationships:
      apRadios:
        grid_display: false
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # Aruba - wlanAPNumRadios
      # Cisco - bsnAPNumOfSlots
      radioCount:
        label: Radio Slots
        type: int
        order: 3
        details_display: false
      # Aruba - wlanAPLocation, wlanAPSysLocation?
      # Cisco - bsnAPLocation
      location:
        label: Location
        order: 4
      # Aruba - wlanAPSwVersion
      # Cisco - bsnAPSoftwareVersion
      swVersion:
        label: Software Version
        order: 10
        details_display: false
      # Aruba - wlanAPModelName
      # Cisco - bsnAPModel
      model:
        label: Model
        grid_display: true
        order: 1
        label_width: 115
        content_width: 115
      # Aruba - wlanAPSerialNumber
      # Cisco - bsnAPSerialNumber
      serial:
        label: Serial Number
        short_label: Serial
        order: 2
      # Aruba - wlanAPIpAddress
      # Cisco - bsnApIpAddress
      ip:
        label: IP Address
        grid_display: true
        order: 5
        label_width: 80
        content_width: 80
      # Aruba - wlanAPConfigNetmask
      # Cisco - bsnAPNetmask
      netmask:
        label: Netmask
        order: 6
        details_display: false
      # Aruba - wlanAPConfigGateway
      # Cisco - bsnAPGateway
      gateway:
        label: Default Gateway
        order: 7
        details_display: false
      # Aruba - lldpNeighborSysName
      # Cisco - clcCdpApCacheNeighName
      neighborName:
        label: Neighbor Name
        short_label: Neighbor
        order: 13
      # Aruba - lldpNeighborManAddr
      # Cisco - clcCdpApCacheNeighAddress
      neighborIp:
        label: Neighbor IP Address
        short_label: Neighbor IP
        order: 14
      # Aruba - lldpNeighborPortId
      # Cisco - clcCdpApCacheNeighInterface
      neighborInterface:
        label: Neighbor Interface
        short_label: Neighbor Int
        order: 16

  ArubaAP:
    base: [AccessPoint]
    label: Access Point
    short_label: AP
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # wlanAPHwVersion
      hwVersion:
        label: Hardware Version
        short_label: Hardware
        type: string
      # wlanAPUnprovisioned
      provisioned:
        label: Provisioned
        type: boolean
        # Modeler will have invert the value
        enum: {true: "clear", false: "critical"}
        renderer: Zenoss.render.severity
        label_width: 25
        content_width: 25
        details_display: false

  ArubaInstantAP:
    base: [ArubaAP]
    label: Access Point
    short_label: AP

  CiscoAP:
    base: [AccessPoint]
    label: Access Point
    short_label: AP
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # bsnAPBootVersion
      bootVersion:
        label: Boot Version
        short_label: Boot
      # bsnAPAdminStatus
      enabled:
        label: Enabled
        type: boolean
        #enum: {1: "Enabled", 2: "Disabled"}
        enum: {true: "clear", false: "debug"}
        renderer: Zenoss.render.severity
        grid_display: true
        label_width: 35
        content_width: 35
        details_display: false
      # bsnAPIOSVersion
      iosVersion:
        label: IOS Version
        short_label: IOS
      # bsnAPEthernetMacAddress
      mac:
        label: MAC Address
        short_label: MAC
      # clcCdpApCachePlatform
      neighborModel:
        label: Neighbor Model
        order: 15
      # bsnAPDot3MacAddress
      radioMac:
        label: Base Radio MAC Address
        short_label: Radio MAC

  APGroup:
    label: Access Point Group
    short_label: Group
    relationships:
      accessPoints:
        label_width: 35
        content_width: 35
    properties:
      DEFAULTS:
        type: string
        grid_display: true
        details_display: true
      # Cisco - bsnAPGroupsVlanDescription
      description:
        label: Description
        order: 2
        label_width: 300
        content_width: 300

  APRadio:
    label: Access Point Radio
    short_label: Radio
    relationships:
      accessPoint:
        grid_display: false
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # Aruba - wlanAPRadioType
      # Cisco - bsnAPIfType
      band:
        label: Band
        grid_display: true
        order: 1
        label_width: 45
        content_width: 45
      # Aruba - wlanAPExternalAntenna (on AP)
      # Cisco - bsnAPIfPhyAntennaType
      antenna:
        label: Antenna Type
        short_label: Antenna
        grid_display: true
        order: 4
        label_width: 55
        content_width: 55
      # Aruba - wlanAPRadioChannel
      # Cisco - bsnAPIfPhyChannelNumber
      channel:
        label: Channel Number
        short_label: Channel
        type: int
        grid_display: true
        order: 2
        label_width: 40
        content_width: 40
      # Aruba - wlanAPdot11aAntennaGain, wlanAPdot11gAntennaGain (on AP)
      # Cisco - bsnAPIfAntennaGain
      gain:
        label: Antenna Gain (dBm)
        short_label: Gain
        type: float
        order: 5

  ArubaAPRadio:
    base: [APRadio]
    label: Access Point Radio
    short_label: Radio
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # wlanAPRadioNumAssociatedClients
      clients:
        label: Clients
        short_label: Clients
        type: int
        grid_display: true
        details_display: false
        datapoint: wlanAPRadioNumAssociatedClients_wlanAPRadioNumAssociatedClients
        order: 20
        label_width: 35
        content_width: 35
      # wlanAPRadioUtilization
      channelUtil:
        label: Channel Utilization
        short_label: Util
        type: int
        grid_display: true
        details_display: false
        datapoint: wlanAPRadioUtilization_wlanAPRadioUtilization
        label_width: 35
        content_width: 35
      # wlanAPRadioHTMode
      htMode:
        label: High-Throughput Mode
        short_label: HT Mode
        type: string

  CiscoAPRadio:
    base: [APRadio]
    label: Access Point Radio
    short_label: Radio
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # bsnAPIfPhyAntennaMode
      mode:
        label: Antenna Mode
        order: 6
      # bsnAPIfPhyChannelAssignment
      assignment:
        label: Channel Assignment
        short_label: Assignment
        order: 3
      # bsnAPIfPhyAntennaDiversity
      diversity:
        label: Antenna Diversity
        short_label: Diversity
        order: 7
      # bsnAPIfAdminStatus
      enabled:
        label: Enabled
        type: boolean
        #enum: {1: "Enabled", 2: "Disabled"}
        enum: {true: "clear", false: "debug"}
        renderer: Zenoss.render.severity
        grid_display: true
        order: 9
        label_width: 35
        content_width: 35
        details_display: false
      # bsnApIfNoOfUsers
      clients:
        label: Clients
        short_label: Clients
        type: int
        grid_display: true
        details_display: false
        datapoint: bsnApIfNoOfUsers_bsnApIfNoOfUsers
        order: 20
        label_width: 35
        content_width: 35

  ArubaRemoteController:
    label: Aruba Controller
    short_label: Controller
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # wlsxSysExtSwitchListEntry indexes
      ip:
        label: IP Address
        short_label: IP
        type: string
        grid_display: true
        label_width: 80
        content_width: 80
      # sysExtSwitchLocation
      location:
        label: Location
        grid_display: true
      # sysExtSwitchSerNo
      serial:
        label: Serial
      # sysExtSwitchStatus
      status:
        label: Status
        type: int
        #enum: {1: "Active", 2: "Inactive"}
        enum: {1: "clear", 2: "critical"}
        renderer: Zenoss.render.severity
        grid_display: true
        details_display: false
      # sysExtSwitchSWVersion
      swVersion:
        label: Software Version
        short_label: OS
        grid_display: false

  ArubaLocalController:
    base: [ArubaRemoteController]
    label: Local Controller
    short_label: Local

  ArubaMasterController:
    base: [ArubaRemoteController]
    label: Master Controller
    plural_label: Master Controller
    short_label: Master
    plural_short_label: Master

  # Aruba does not report on this via SNMP
  DHCPPool:
    label: DHCP Pool
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # Cisco - agentDhcpScopeDnsServerAddress(1|2|3)
      dns:
        label: DNS Servers
        short_label: DNS
        type: lines
        order: 6
      # Cisco - agentDhcpScopeDnsDomainName
      domain:
        label: DNS Domain
        short_label: Domain
        order: 7
      # Cisco - agentDhcpScopeState
      enabled:
        label: Enabled
        type: bool
        enum: {true: "clear", false: "debug"}
        renderer: Zenoss.render.severity
        grid_display: true
        details_display: false
        order: 10
        label_width: 35
        content_width: 35
      # Cisco - agentDhcpScopePoolEndAddress
      end:
        label: Ending IP Address
        short_label: End IP
        grid_display: true
        order: 2
        label_width: 80
        content_width: 80
      # Cisco - agentDhcpScopeNetwork, agentDhcpScopeNetmask
      network:
        label: Network
        grid_display: true
        order: 3
        label_width: 90
        content_width: 90
      # Cisco - agentDhcpScopeDefaultRouterAddress(1|2|3)
      routers:
        label: Default Gateways
        short_label: Gateways
        type: lines
        order: 5
      # Cisco - agentDhcpScopePoolStartAddress
      start:
        label: Starting IP Address
        short_label: Start IP
        grid_display: true
        order: 1
        label_width: 80
        content_width: 80

  # Should this extend Products.ZenModel.Software?
  License:
    label: License
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # Aruba - licenseService (colon split)
      # Cisco - clmgmtLicenseMaxUsageCount
      count:
        label: Count
        type: int
        grid_display: true
      # Aruba - sysExtLicenseExpires
      # Cisco - clmgmtLicenseValidityPeriodRemaining (calculate)
      expiration:
        label: Expiration Date
        short_label: Expiration
      # Aruba - licenseService (colon split)
      # clmgmtLicenseFeatureName
      feature:
        label: Feature
        grid_display: true
      status:
        label: Status
      # Aruba - sysExtLicenseFlags
      #         E - enabled
      #         A - auto-generated
      #         R - reboot required
      # Cisco - clmgmtLicenseStatus
      #         1 - inactive
      #         2 - not in use
      #         3 - in use
      #         4 - expired, in use
      #         5 - expired, not in use
      #         6 - usage count consumed
      statusSev:
        label: Status
        enum:
          E: "clear"
          A: "clear"
          R: "warning"
          1: "debug"
          2: "debug"
          3: "clear"
          4: "critical"
          5: "debug"
          6: "critical"
        renderer: Zenoss.render.severity
        details_display: false

  # "Interfaces" on Cisco WLC (physical interfaces are "ports")
  # "VLANs" on Aruba
  # Should this extend Products.ZenModel.IpInterface?
  VlanInterface:
    label: VLAN Interface
    short_label: VLAN
    properties:
      DEFAULTS:
        type: string
        grid_display: true
        details_display: true
      # Aruba - ifExtVlanInterfaceIpAddress
      # Cisco - agentInterfaceIPAddress
      ip:
        label: IP Address
        short_label: IP
        order: 2
        label_width: 80
        content_width: 80
      # Aruba does not appear to report the MAC
      # Cisco - agentInterfaceMacAddress
      mac:
        label: MAC Address
        short_label: MAC
        order: 4
      # Aruba - ifExtVlanInterfaceIpMask
      # Cisco - agentInterfaceIPNetmask
      netmask:
        label: Netmask
        order: 3
        label_width: 80
        content_width: 80
      # Aruba - wlsxIfExtVlanEntry indexes
      # Cisco - agentInterfaceVlanId
      vlan:
        label: VLAN
        type: int
        order: 1

  AAAServer:
    label: AAA Server
    short_label: AAA
    properties:
      DEFAULTS:
        grid_display: true
        details_display: true
      # Aruba - authServerInservice, authServerState?
      enabled:
        label: Enabled
        type: bool
        enum: {true: "clear", false: "debug"}
        renderer: Zenoss.render.severity
        details_display: false
        label_width: 35
        content_width: 35
      # Aruba - authServerAddress
      ip:
        label: IP Address
        short_label: IP
        type: string
        label_width: 80
        content_width: 80
      # Aruba - authServerPort
      port:
        label: Port
        type: int

  # Cisco doesn't appear to report stats on this
  InternalDB:
    base: [AAAServer]
    label: Internal User Database
    short_label: Internal DB
    properties:
      port:
        grid_display: false
        details_display: false

  LDAPServer:
    base: [AAAServer]
    label: LDAP Server
    short_label: LDAP
    # enabled
    # Cisco - cldlServerState
    # ip
    # Cisco - cldlServerAddress
    # port
    # Cisco - cldlServerPortNum

  RadiusServer:
    base: [AAAServer]
    label: RADIUS Server
    short_label: RADIUS

  RadAcctServer:
    base: [RadiusServer]
    label: RADIUS Accounting Server
    short_label: RADIUS Acct
    # enabled
    # Cisco - bsnRadiusAccServerStatus
    # ip
    # Cisco - bsnRadiusAccServerAddress
    # port
    # Cisco - bsnRadiusAccClientServerPortNumber

  RadAuthServer:
    base: [RadiusServer]
    label: RADIUS Authentication Server
    short_label: RADIUS Auth
    # enabled
    # Cisco - bsnRadiusAuthServerStatus
    # ip
    # Cisco - bsnRadiusAuthServerAddress
    # port
    # Cisco - bsnRadiusAuthClientServerPortNumber

  # Not supported for WLAN auth on Cisco, only management
  # Stats not available on Cisco
  TacacsServer:
    base: [AAAServer]
    label: TACACS Server
    short_label: TACACS
    # enabled
    # Cisco - claTacacsServerEnabled.(type)
    #         1 - authn
    #         2 - authz
    #         3 - acct
    # ip
    # Cisco - claTacacsServerAddress.(type)
    # port
    # Cisco - claTacacsServerPortNum.(type)

  TacAcctServer:
    base: [TacacsServer]
    label: TACACS Accounting Server
    short_label: TACACS Acct

  TacAuthnServer:
    base: [TacacsServer]
    label: TACACS Authentication Server
    short_label: TACACS Authn

  # Unknown if supported on Aruba
  TacAuthzServer:
    base: [TacacsServer]
    label: TACACS Authorization Server
    short_label: TACACS Authz

  # Not supported on Cisco
  WindowsServer:
    base: [AAAServer]
    label: Windows Server
    short_label: Windows

  WLAN:
    label: Wireless LAN
    short_label: WLAN
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # Aruba - wlanESSIDEncryptionType
      # Cisco - cLWSecDot11EssCckmTable
      #         + cLWSecDot11EssCkipEntry
      #         + bsnDot11EssWebSecurity
      #         + bsnDot11EssStaticWEPSecurity
      #         + bsnDot11Ess8021xSecurity
      security:
        label: Security
        short_label: Security
        grid_display: true
        order: 5
        # To fit "WPA-TKIP/WPA2-AES+TKIP PSK + WebAuth + MAC Filter" at max
        label_width: 285
        content_width: 285
      # Aruba - indexes of WlanESSIDEntry
      # Cisco - cLWlanSsid, bsnDot11EssSsid
      ssid:
        label: SSID
        order: 1

  ArubaWLAN:
    base: [WLAN]
    label: Wireless LAN
    short_label: WLAN
    properties:
      DEFAULTS:
        type: int
        grid_display: true
        details_display: true
      # wlanESSIDNumAccessPointsUp
      accessPoints:
        label: Access Points
        short_label: APs
        datapoint: wlanESSIDNumAccessPointsUp_wlanESSIDNumAccessPointsUp
        label_width: 35
        content_width: 35
      # wlanESSIDNumStations
      clients:
        label: Clients
        datapoint: wlanESSIDNumStations_wlanESSIDNumStations
        label_width: 35
        content_width: 35

  CiscoWLAN:
    base: [WLAN]
    label: Wireless LAN
    short_label: WLAN
    properties:
      DEFAULTS:
        grid_display: false
        details_display: true
      # bsnDot11EssBroadcastSsid
      broadcast:
        label: Broadcast
        type: boolean
        enum: {true: "clear", false: "debug"}
        renderer: Zenoss.render.severity
        grid_display: true
        details_display: false
        order: 6
        label_width: 45
        content_width: 45
      # bsnDot11EssNumberOfMobileStations
      clients:
        label: Clients
        type: int
        datapoint: bsnDot11EssNumberOfMobileStations_bsnDot11EssNumberOfMobileStations
        grid_display: true
        order: 8
        label_width: 35
        content_width: 35
      # bsnDot11EssDhcpServerIpAddress
      dhcp:
        label: DHCP Server
        short_label: DHCP
        type: string
        order: 13
      # bsnDot11EssAdminStatus
      enabled:
        label: Enabled
        type: boolean
        enum: {true: "clear", false: "debug"}
        renderer: Zenoss.render.severity
        grid_display: true
        details_display: false
        order: 7
        label_width: 35
        content_width: 35
      # cldlWlanLdap(Primary|Secondary|Teriary)ServerIndex
      ldap:
        label: LDAP Servers
        short_label: LDAP
        type: lines
        order: 12
      # cLWlanProfileName
      profile:
        label: Profile
        type: string
        order: 2
      # bsnDot11EssRadiusAcct(Primary|Secondary|Tertiary)Server
      radAcct:
        label: RADIUS Accounting Servers
        short_label: RADIUS Acct
        type: lines
        order: 11
      # bsnDot11EssRadiusAuth(Primary|Secondary|Tertiary)Server
      radAuth:
        label: RADIUS Authentication Servers
        short_label: RADIUS Auth
        type: lines
        order: 10
 
  # cLWlanLanSubType, cLWlanIsWired
  CiscoGuestLAN:
    base: [CiscoWLAN]
    label: Guest LAN

  # cLWlanLanSubType
  CiscoRemoteLAN:
    base: [CiscoWLAN]
    label: Remote LAN


zProperties:
  DEFAULTS:
    category: WLAN
  zWlanApClientThreshold:
    type: int
    default: 64
  zWlanApGroupIgnoreNames:
    type: string
  zWlanApIgnoreNames:
    type: string
  zWlanApIgnoreSubnets:
    type: lines
  zWlanApIgnoreModels:
    type: lines
  zWlanDhcpIgnoreNames:
    type: string
  zWlanDhcpIgnoreSubnets:
    type: lines
  zWlanInterfaceIgnoreNames:
    type: string
  zWlanInterfaceIgnoreSubnets:
    type: lines
  zWlanInterfaceIgnoreVlans:
    type: lines
  zWlanServerIgnoreNames:
    type: string
  zWlanServerIgnoreSubnets:
    type: lines
  zWlanServerIgnoreTypes:
    type: lines
  zWlanWlanIgnoreNames:
    type: string


device_classes:
  /Network/Aruba/Controller:
    remove: true
    zProperties:
      zCollectorPlugins:
        - zenoss.snmp.DeviceMap
        - zenoss.snmp.InterfaceMap
        - zenoss.snmp.RouteMap
        - zenoss.snmp.SnmpV3EngineIdMap
        - daviswr.snmp.ArubaControllerDevice
        - daviswr.snmp.ArubaControllerAAA
        - daviswr.snmp.ArubaControllerAP
        - daviswr.snmp.ArubaControllerCPU
        - daviswr.snmp.ArubaControllerFan
        - daviswr.snmp.ArubaControllerLicense
        - daviswr.snmp.ArubaControllerMasterLocal
        - daviswr.snmp.ArubaControllerPowerSupply
        - daviswr.snmp.ArubaControllerTemperature
        - daviswr.snmp.ArubaControllerVLAN
        - daviswr.snmp.ArubaControllerWLAN
      zPythonClass: ZenPacks.daviswr.WirelessController.ArubaController

  # To avoid conflict with /Network/Cisco/WLC from the Enterprise ZenPacks
  /Network/Cisco/Controller:
    remove: true
    zProperties:
      zCollectorPlugins:
        - zenoss.snmp.DeviceMap
        - zenoss.snmp.InterfaceMap
        - zenoss.snmp.RouteMap
        - zenoss.snmp.SnmpV3EngineIdMap
        - daviswr.snmp.CiscoControllerDevice
        - daviswr.snmp.CiscoControllerAAA
        - daviswr.snmp.CiscoControllerAP
        - daviswr.snmp.CiscoControllerDHCPPool
        - daviswr.snmp.CiscoControllerLicense
        - daviswr.snmp.CiscoControllerTemperature
        - daviswr.snmp.CiscoControllerVLAN
        - daviswr.snmp.CiscoControllerWLAN
      zPythonClass: ZenPacks.daviswr.WirelessController.CiscoController
