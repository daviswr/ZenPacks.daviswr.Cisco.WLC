name: ZenPacks.daviswr.WirelessController

class_relationships:
  - Controller(aaaServers) 1:MC AAAServer(controller)
  - Controller(apGroups) 1:MC APGroup(controller)
  - Controller(dhcpPools) 1:MC DHCPPool(controller)
  - Controller(license) 1:MC License(controller)
  - Controller(vlanInterfaces) 1:MC vlanInterface(controller)
  - Controller(wlans) 1:MC WLAN(controller)
  - APGroup(accessPoints) 1:MC AccessPoint(apGroup)
  - AccessPoint(apRadios) 1:MC APRadio(accessPoint)
  # Aruba-specific
  - ArubaController(arubaRemoteController) 1:MC ArubaRemoteController(controller)
  # Use stock component classes for CPU, fan, and power
  # Non-containing relationships
  #- WLAN(aaaServers) M:M AAAServer(wlans)


classes:
  DEFAULTS:
    base: [zenpacklib.Component]

  Controller:
    base: [zenpacklib.Device]
    label: Wireless Controller
    short_label: Controller
    properties:
      apCount:
        type: int
      # Set by license modeler
      maxAPs:
        type: int
      # Cisco - bsnRFMobilityDomainName
      mobilityDomains:
        type: lines
      # Cisco - agentInventoryMaxNumberOfAPsSupported 
      platformMaxAPs:
        type: int
      # Aruba - wlsxSwitchRole
      # Cisco - Check licenses to determine if HA SKU?
      role:
        type: string

  ArubaController:
    base: [Controller]
    label: Aruba Mobility Controller
    short_label: Aruba Controller
    properties:
      isLocal:
        type: boolean
      isMaster:
        type: boolean
      # wlsxSwitchMasterIp
      masterIP:
        type: string

  ArubaInstantController:
    base: [ArubaController]
    label: Aruba Instant Virtual Controller
    short_label: Aruba Instant
    
  CiscoController:
    base: [Controller]
    label: Cisco Wireless LAN Controller
    short_label: Cisco WLC

  CiscoIOSController:
    base: [CiscoController]
    label: Cisco IOS Wireless Controller
    short_label: Cisco IOS WLC
      
  AccessPoint:
    label: Access Point
    short_label: AP
    relationships:
      apRadios:
        grid_display: false
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # Aruba - wlanAPNumRadios
      # Cisco - bsnAPNumOfSlots
      radioCount:
        label: Radio Slots
        type: int
        order: 3
        details_display: false
      # Aruba - wlanAPLocation, wlanAPSysLocation?
      # Cisco - bsnAPLocation
      location:
        label: Location
        order: 4
      # Aruba - wlanAPSwVersion
      # Cisco - bsnAPSoftwareVersion
      swVersion:
        label: Software Version
        order: 10
        details_display: false
      # Aruba - wlanAPModelName
      # Cisco - bsnAPModel
      model:
        label: Model
        grid_display: true
        order: 1
        label_width: 115
        content_width: 115
      # Aruba - wlanAPSerialNumber
      # Cisco - bsnAPSerialNumber
      serial:
        label: Serial Number
        short_label: Serial
        order: 2
      # Aruba - wlanAPIpAddress
      # Cisco - bsnApIpAddress
      ip:
        label: IP Address
        grid_display: true
        order: 5
        label_width: 80
        content_width: 80
      # Aruba - wlanAPConfigNetmask
      # Cisco - bsnAPNetmask
      netmask:
        label: Netmask
        order: 6
        details_display: false
      # Aruba - wlanAPConfigGateway
      # Cisco - bsnAPGateway
      gateway:
        label: Default Gateway
        order: 7
        details_display: false
      # Aruba - lldpNeighborSysName
      # Cisco - clcCdpApCacheNeighName
      neighborName:
        label: Neighbor Name
        short_label: Neighbor
        order: 13
      # Aruba - lldpNeighborManAddr
      # Cisco - clcCdpApCacheNeighAddress
      neighborIp:
        label: Neighbor IP Address
        short_label: Neighbor IP
        order: 14
      # Aruba - lldpNeighborPortId
      # Cisco - clcCdpApCacheNeighInterface
      neighborInterface:
        label: Neighbor Interface
        short_label: Neighbor Int
        order: 16

  ArubaAP:
    base: [AccessPoint]
    label: Access Point
    short_label: AP
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # wlanAPHwVersion
      hwVersion:
        label: Hardware Version
        short_label: Hardware
        type: string
      # wlanAPUnprovisioned
      provisioned:
        label: Provisioned
        type: boolean
        # Modeler will have invert the value
        enum: {true: "clear", false: "critical"}
        renderer: Zenoss.render.severity
        label_width: 25
        content_width: 25
        details_display: false

  ArubaInstantAP:
    base: [ArubaAP]
    label: Access Point
    short_label: AP

  CiscoAP:
    base: [AccessPoint]
    label: Access Point
    short_label: AP
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # bsnAPBootVersion
      bootVersion:
        label: Boot Version
        short_label: Boot
      # bsnAPAdminStatus
      enabled:
        label: Enabled
        type: boolean
        #enum: {1: "Enabled", 2: "Disabled"}
        enum: {true: "clear", false: "debug"}
        renderer: Zenoss.render.severity
        grid_display: true
        label_width: 35
        content_width: 35
        details_display: false
      # bsnAPIOSVersion
      iosVersion:
        label: IOS Version
        short_label: IOS
      # bsnAPEthernetMacAddress
      mac:
        label: MAC Address
        short_label: MAC
      # clcCdpApCachePlatform
      neighborModel:
        label: Neighbor Model
        order: 15
      # bsnAPDot3MacAddress
      radioMac:
        label: Base Radio MAC Address
        short_label: Radio MAC

  APGroup:
    label: Access Point Group
    short_label: Group
    relationships:
      accessPoints:
        label_width: 35
        content_width: 35
    properties:
      DEFAULTS:
        type: string
        grid_display: true
        details_display: true
      # Cisco - bsnAPGroupsVlanDescription
      description:
        label: Description
        order: 2
        label_width: 300
        content_width: 300

  APRadio:
    label: Access Point Radio
    short_label: Radio
    relationships:
      accessPoint:
        grid_display: false
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # Aruba - wlanAPRadioType
      # Cisco - bsnAPIfType
      band:
        label: Band
        grid_display: true
        order: 1
        label_width: 45
        content_width: 45
      # Aruba - wlanAPExternalAntenna (on AP)
      # Cisco - bsnAPIfPhyAntennaType
      antenna:
        label: Antenna Type
        short_label: Antenna
        grid_display: true
        order: 4
        label_width: 55
        content_width: 55
      # Aruba - wlanAPRadioChannel
      # Cisco - bsnAPIfPhyChannelNumber
      channel:
        label: Channel Number
        short_label: Channel
        type: int
        grid_display: true
        order: 2
        label_width: 40
        content_width: 40
      # Aruba - wlanAPdot11aAntennaGain, wlanAPdot11gAntennaGain (on AP)
      # Cisco - bsnAPIfAntennaGain
      gain:
        label: Antenna Gain (dBm)
        short_label: Gain
        type: float
        order: 5

  ArubaAPRadio:
    base: [APRadio]
    label: Access Point Radio
    short_label: Radio
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # wlanAPRadioNumAssociatedClients
      clients:
        label: Clients
        short_label: Clients
        type: int
        grid_display: true
        details_display: false
        datapoint: wlanAPRadioNumAssociatedClients_wlanAPRadioNumAssociatedClients
        order: 20
        label_width: 35
        content_width: 35
      # wlanAPRadioUtilization
      channelUtil:
        label: Channel Utilization
        short_label: Util
        type: int
        grid_display: true
        details_display: false
        datapoint: wlanAPRadioUtilization_wlanAPRadioUtilization
        label_width: 35
        content_width: 35
      # wlanAPRadioHTMode
      htMode:
        label: High-Throughput Mode
        short_label: HT Mode
        type: string

  CiscoAPRadio:
    base: [APRadio]
    label: Access Point Radio
    short_label: Radio
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # bsnAPIfPhyAntennaMode
      mode:
        label: Antenna Mode
        order: 6
      # bsnAPIfPhyChannelAssignment
      assignment:
        label: Channel Assignment
        short_label: Assignment
        order: 3
      # bsnAPIfPhyAntennaDiversity
      diversity:
        label: Antenna Diversity
        short_label: Diversity
        order: 7
      # bsnAPIfAdminStatus
      enabled:
        label: Enabled
        type: boolean
        #enum: {1: "Enabled", 2: "Disabled"}
        enum: {true: "clear", false: "debug"}
        renderer: Zenoss.render.severity
        grid_display: true
        order: 9
        label_width: 35
        content_width: 35
        details_display: false
      # bsnApIfNoOfUsers
      clients:
        label: Clients
        short_label: Clients
        type: int
        grid_display: true
        details_display: false
        datapoint: bsnApIfNoOfUsers_bsnApIfNoOfUsers
        order: 20
        label_width: 35
        content_width: 35

  ArubaRemoteController:
    label: Aruba Controller
    short_label: Controller

  ArubaLocalController:
    base: [ArubaRemoteController]
    label: Local Controller
    short_label: Local

  ArubaMasterController:
    base: [ArubaRemoteController]
    label: Master Controller
    short_label: Master

  DHCPPool:
    label: DHCP Pool

  License:
    label: License

  # "Interfaces" on Cisco WLC (physical interfaces are "ports")
  # "VLANs" on Aruba
  VlanInterface:
    label: VLAN Interface
    short_label: VLAN

  AAAServer:
    label: AAA Server
    short_label: AAA

  LDAPServer:
    base: [AAAServer]
    label: LDAP Server
    short_label: LDAP

  RadiusServer:
    base: [AAAServer]
    label: RADIUS Server
    short_label: RADIUS

  RadAcctServer:
    base: [RadiusServer]
    label: RADIUS Accounting Server
    short_label: RADIUS Acct

  RadAuthServer:
    base: [RadiusServer]
    label: RADIUS Authentication Server
    short_label: RADIUS Auth

  # Not supported for WLAN auth on Cisco WLC, only management
  # Stats not available on Cisco WLC
  TacacsServer:
    base: [AAAServer]
    label: TACACS Server
    short_label: TACACS

  # Not supported on Cisco WLC
  WindowsServer:
    base: [AAAServer]
    label: Windows Server
    short_label: Windows

  WLAN:
    label: Wireless LAN
    short_label: WLAN
    properties:
      DEFAULTS:
        type: string
        grid_display: false
        details_display: true
      # Aruba - wlanESSIDEncryptionType
      # Cisco - cLWSecDot11EssCckmTable
      #         + cLWSecDot11EssCkipEntry
      #         + bsnDot11EssWebSecurity
      #         + bsnDot11EssStaticWEPSecurity
      #         + bsnDot11Ess8021xSecurity
      security:
        label: Security
        short_label: Security
        grid_display: true
        order: 5
        # To fit "WPA-TKIP/WPA2-AES+TKIP 802.1x+CCKM + MAC Filter" at max
        label_width: 275
        content_width: 275
      # Aruba - indexes of WlanESSIDEntry
      # Cisco - cLWlanSsid, bsnDot11EssSsid
      ssid:
        label: SSID
        order: 1

  ArubaWLAN:
    base: [WLAN]
    label: Wireless LAN
    short_label: WLAN
    properties:
      DEFAULTS:
        type: int
        grid_display: true
        details_display: true
      # wlanESSIDNumAccessPointsUp
      accessPoints:
        label: Access Points
        short_label: APs
        datapoint: wlanESSIDNumAccessPointsUp_wlanESSIDNumAccessPointsUp
        label_width: 35
        content_width: 35
      # wlanESSIDNumStations
      clients:
        label: Clients
        datapoint: wlanESSIDNumStations_wlanESSIDNumStations
        label_width: 35
        content_width: 35

  CiscoWLAN:
    base: [WLAN]
    label: Wireless LAN
    short_label: WLAN
    properties:
      DEFAULTS:
        grid_display: true
        details_display: true
      # bsnDot11EssBroadcastSsid
      broadcast:
        label: Broadcast
        type: boolean
        enum: {true: "clear", false: "debug"}
        renderer: Zenoss.render.severity
        details_display: false
        order: 6
        label_width: 45
        content_width: 45
      # bsnDot11EssNumberOfMobileStations
      clients:
        label: Clients
        type: int
        datapoint: bsnDot11EssNumberOfMobileStations_bsnDot11EssNumberOfMobileStations
        order: 8
        label_width: 35
        content_width: 35
      # bsnDot11EssAdminStatus
      enabled:
        label: Enabled
        type: boolean
        enum: {true: "clear", false: "debug"}
        renderer: Zenoss.render.severity
        details_display: false
        order: 7
        label_width: 35
        content_width: 35
      # cLWlanProfileName
      profile:
        label: Profile
        type: string
        grid_display: false
        order: 2
      # bsnDot11EssRadiusAuth(Primary|Secondary|Tertiary)Server
      radAuth:
        label: RADIUS Authentication Servers
        type: lines
        grid_display: false
        order: 10
      # bsnDot11EssRadiusAcct(Primary|Secondary|Tertiary)Server
      radAcct:
        label: RADIUS Accounting Servers
        type: lines
        grid_display: false
        order: 11
 
  # cLWlanLanSubType, cLWlanIsWired
  CiscoGuestLAN:
    base: [CiscoWLAN]
    label: Guest LAN

  # cLWlanLanSubType
  CiscoRemoteLAN:
    base: [CiscoWLAN]
    label: Remote LAN


zProperties:
  DEFAULTS:
    category: WLAN
  zWlanApClientThreshold:
    type: int
    default: 64
  zWlanApGroupIgnoreNames:
    type: string
  zWlanApIgnoreNames:
    type: string
  zWlanApIgnoreSubnets:
    type: lines
  zWlanApIgnoreModels:
    type: lines
  zWlanWlanIgnoreNames:
    type: string
  zWlanServerIgnoreNames:
    type: string
  zWlanServerIgnoreSubnets:
    type: lines
  zWlanServerIgnoreTypes:
    type: lines
  zWlanInterfaceIgnoreNames:
    type: string
  zWlanInterfaceIgnoreSubnets:
    type: lines


device_classes:
  # To avoid conflict with /Network/Cisco/WLC from the Enterprise ZenPacks
  /Network/Cisco/Controller:
    remove: true
    zProperties:
      zCollectorPlugins:
        - zenoss.snmp.DeviceMap
        - zenoss.snmp.InterfaceMap
        - zenoss.snmp.RouteMap
        - zenoss.snmp.SnmpV3EngineIdMap
        - daviswr.snmp.CiscoController
        - daviswr.snmp.CiscoAP
        - daviswr.snmp.CiscoWLAN
      zPythonClass: ZenPacks.daviswr.WirelessController.CiscoController

  /Network/Aruba/Controller:
    remove: true
    zProperties:
      zCollectorPlugins:
        - zenoss.snmp.DeviceMap
        - zenoss.snmp.InterfaceMap
        - zenoss.snmp.RouteMap
        - zenoss.snmp.SnmpV3EngineIdMap
      zPythonClass: ZenPacks.daviswr.WirelessController.ArubaController
